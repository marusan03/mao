## âœ… Phase 0å®Œäº†: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¢ºèªå®Œäº†

ç†è§£ã—ãŸå†…å®¹ã‚’æ•´ç†ã—ã¾ã™ã€‚

---

## ğŸ“š ç†è§£ã—ãŸæ—¢å­˜å®Ÿè£…

### 1. **AgentLogger** (`mao/orchestrator/agent_logger.py`)
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã”ã¨ã«ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ« (`.mao/logs/<agent_id>.log`) ã‚’ä½œæˆ
- `thinking()`, `action()`, `result()`, `error()` ãªã©ã®ãƒ­ã‚°API
- tmuxãƒšã‚¤ãƒ³ã§ `tail -f` ã—ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º

### 2. **ApprovalQueue** (`mao/orchestrator/approval_queue.py`)
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Œäº†å¾Œã®æ‰¿èªç®¡ç†
- `.mao/approval_queue/index.json` ã«ã‚­ãƒ¥ãƒ¼ä¿å­˜
- `PENDING`, `APPROVED`, `REJECTED` ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†

### 3. **AgentExecutor** (`mao/orchestrator/agent_executor.py`)
- Claude APIçµŒç”±ã§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ
- ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°/éã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ä¸¡å¯¾å¿œ

### 4. **`/spawn-agent` ã‚¹ã‚­ãƒ«** (`.mao/skills/spawn-agent.yaml`)
- CTOãŒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’èµ·å‹•ã™ã‚‹å°‚ç”¨ã‚¹ã‚­ãƒ«
- `[MAO_AGENT_SPAWN]` JSONãƒãƒ¼ã‚«ãƒ¼ã§ã‚·ã‚¹ãƒ†ãƒ ã«é€šçŸ¥

---

## ğŸ¯ ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æœ›ã®å†ç¢ºèª

> **CTOã¨ã®å¯¾è©±ã«ã€å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®é€²è¡ŒçŠ¶æ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ãŸã„**
> - ã‚­ãƒ¥ãƒ¼ãƒ™ãƒ¼ã‚¹ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³2) ã¾ãŸã¯ã‚¹ã‚­ãƒ«åŒ– (ã‚ªãƒ—ã‚·ãƒ§ãƒ³3) ãŒè‰¯ã„
> - ã‚¿ã‚¹ã‚¯æ¸¡ã—ãŸã‚‰ä¸€æ—¦CTOã¯ã‚­ãƒ¥ãƒ¼ã‚’ç¢ºèªã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å©ãå¾…æ©Ÿ
> - ã‚­ãƒ¥ãƒ¼ã«å…¥ã£ã¦ããŸã‚‰ã¾ãŸæ€è€ƒã‚’ç¶šã‘ã‚‹

---

## ğŸ¯ å®Ÿè£…ææ¡ˆ

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³2 (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼) + ã‚¹ã‚­ãƒ«åŒ– (ã‚ªãƒ—ã‚·ãƒ§ãƒ³3) ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰**ã‚’ææ¡ˆã—ã¾ã™ã€‚

### è¨­è¨ˆæ¦‚è¦:

#### 1. **`AgentProgressQueue` ã‚¯ãƒ©ã‚¹** (æ–°è¦ä½œæˆ)
- **ãƒ¡ãƒ¢ãƒªãƒ™ãƒ¼ã‚¹**ã®é€²æ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒé€²æ—ã‚’é€ä¿¡: `progress_queue.add_message(agent_id, log_level, message)`
- CTOãŒãƒãƒ¼ãƒªãƒ³ã‚°: `progress_queue.get_new_messages(since_timestamp)`
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—: `thinking`, `action`, `result`, `error`

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```python
@dataclass
class ProgressMessage:
    id: str
    agent_id: str
    timestamp: float
    log_level: str  # "thinking", "action", "result", "error"
    message: str
```

#### 2. **AgentLoggerã®æ‹¡å¼µ**
- `AgentLogger` ã® `thinking()`, `action()`, `result()`, `error()` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ‹¡å¼µ
- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã«åŠ ãˆã¦ã€`AgentProgressQueue` ã«ã‚‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡

#### 3. **CTOã®ç›£è¦–ãƒ«ãƒ¼ãƒ—**
- `/spawn-agent` å®Ÿè¡Œå¾Œã€CTOã¯ `AgentProgressQueue` ã‚’ãƒãƒ¼ãƒªãƒ³ã‚°é–‹å§‹ï¼ˆ2ç§’ã”ã¨ï¼‰
- æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚Œã°CTOãƒãƒ£ãƒƒãƒˆã«è¡¨ç¤º:
  ```
  [Agent a74e8ed] ğŸ’­ æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã¿ä¸­...
  [Agent a74e8ed] ğŸ”§ [Edit] calculator.py ã‚’ç·¨é›†
  [Agent a74e8ed] âœ“ å®Ÿè£…å®Œäº†
  ```
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Œäº† â†’ `ApprovalQueue` ã«é€ä¿¡ â†’ ç›£è¦–çµ‚äº†

#### 4. **ã‚¹ã‚­ãƒ«åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰**
- `/watch-agents` ã‚¹ã‚­ãƒ«ã§ç›£è¦–ON/OFFåˆ‡ã‚Šæ›¿ãˆå¯èƒ½

---

## ğŸš€ ã‚¿ã‚¹ã‚¯åˆ†è§£

ã“ã®ã‚¿ã‚¹ã‚¯ã‚’ä»¥ä¸‹ã®**3ã¤ã®ã‚µãƒ–ã‚¿ã‚¹ã‚¯**ã«åˆ†è§£ã—ã¾ã—ãŸï¼š

### Task 1: **AgentProgressQueueå®Ÿè£…**
- **å½¹å‰²**: ãƒ¡ãƒ¢ãƒªãƒ™ãƒ¼ã‚¹ã®é€²æ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼
- **å ´æ‰€**: `mao/orchestrator/agent_progress_queue.py`
- **API**:
  - `add_message(agent_id, log_level, message)` - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
  - `get_new_messages(since_timestamp=None)` - æ–°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—
  - `get_all_messages()` - å…¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—
  - `clear()` - ã‚¯ãƒªã‚¢
- **æ‹…å½“**: Backend Coder

### Task 2: **AgentLoggerã¨ã®çµ±åˆ**
- **å½¹å‰²**: `AgentLogger` ã‹ã‚‰ `AgentProgressQueue` ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
- **å ´æ‰€**: `mao/orchestrator/agent_logger.py`
- **å¤‰æ›´**:
  - `__init__()` ã§ `AgentProgressQueue` ã‚’å—ã‘å–ã‚‹
  - `thinking()`, `action()`, `result()`, `error()` ã‚’æ‹¡å¼µ
- **æ‹…å½“**: Backend Coder

### Task 3: **CTOç›£è¦–ãƒ«ãƒ¼ãƒ—ã¨UIçµ±åˆ**
- **å½¹å‰²**: CTOãƒãƒ£ãƒƒãƒˆã«é€²æ—ã‚’è¡¨ç¤º
- **å ´æ‰€**:
  - `mao/ui/dashboard.py` (spawn_agent ãƒ¡ã‚½ãƒƒãƒ‰)
  - `mao/ui/widgets/cto_chat_widget.py` (é€²æ—è¡¨ç¤º)
- **æ©Ÿèƒ½**:
  - `/spawn-agent` å¾Œã«ã‚­ãƒ¥ãƒ¼ã‚’ãƒãƒ¼ãƒªãƒ³ã‚°é–‹å§‹
  - æ–°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’CTOãƒãƒ£ãƒƒãƒˆã«è¡¨ç¤º
  - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Œäº†å¾Œã«ç›£è¦–çµ‚äº†
- **æ‹…å½“**: Backend Coder

---

## ğŸ¤” ç¢ºèªäº‹é …

å®Ÿè£…ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ä»¥ä¸‹ã‚’ç¢ºèªã•ã›ã¦ãã ã•ã„ï¼š

1. **ãƒãƒ¼ãƒªãƒ³ã‚°é »åº¦**: 2ç§’ã”ã¨ã§ã‚ˆã„ã§ã™ã‹ï¼Ÿ
2. **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: `thinking`, `action`, `result`, `error` ã®ã¿è¡¨ç¤ºï¼ˆ`debug`, `info` ã¯é™¤å¤–ï¼‰ã§ã‚ˆã„ã§ã™ã‹ï¼Ÿ
3. **UIè¡¨ç¤ºå½¢å¼**: ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã‚ˆã„ã§ã™ã‹ï¼Ÿ
   ```
   [Agent a74e8ed - Backend Coder] ğŸ’­ æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã¿ä¸­...
   [Agent a74e8ed - Backend Coder] ğŸ”§ [Edit] calculator.py ã‚’ç·¨é›†
   [Agent a74e8ed - Backend Coder] âœ“ å®Ÿè£…å®Œäº†
   ```

ã“ã‚Œã§é€²ã‚ã¦ã‚ˆã‘ã‚Œã°ã€Backend Coderã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’èµ·å‹•ã—ã¾ã™ã€‚