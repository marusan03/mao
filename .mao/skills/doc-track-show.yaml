name: doc-track-show
display_name: "ğŸ‘ï¸ Show Document Tracking Status"
description: |
  ã‚¹ã‚­ãƒ«: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¿½è·¡çŠ¶æ³ã‚’è¡¨ç¤ºã™ã‚‹

  ç¾åœ¨è¿½è·¡ä¸­ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€è¦§ã¨ã€æœªæ›´æ–°ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

  ä½¿ç”¨ä¾‹:
    /doc-track-show

category: documentation
version: "1.0.0"

parameters: []

script: |
  #!/usr/bin/env python3
  import sys
  import os
  from pathlib import Path

  # MAOãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
  sys.path.insert(0, str(Path(__file__).parent.parent.parent))
  from mao.orchestrator.document_tracker import DocumentTracker

  # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‘ã‚¹
  project_path = Path(os.environ.get("PWD", "."))

  # ã‚»ãƒƒã‚·ãƒ§ãƒ³IDå–å¾—
  current_session = os.environ.get("MAO_SESSION_ID")
  if not current_session:
      print("âŒ ã‚¨ãƒ©ãƒ¼: MAOã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
      sys.exit(1)

  # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒˆãƒ©ãƒƒã‚«ãƒ¼åˆæœŸåŒ–
  tracker = DocumentTracker(project_path=project_path)

  # ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±å–å¾—
  session_info = tracker.get_session_info(current_session)
  if not session_info:
      print("âŒ ã‚¨ãƒ©ãƒ¼: è¿½è·¡ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
      print("   /doc-track-start ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã¦ãã ã•ã„")
      tracker.close()
      sys.exit(1)

  # è¿½è·¡ä¸­ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå–å¾—
  all_docs = tracker.get_tracked_documents(current_session)
  pending_docs = tracker.get_pending_updates(current_session)

  # ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±è¡¨ç¤º
  print("ğŸ“Š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¿½è·¡çŠ¶æ³")
  print("=" * 60)
  print(f"ã‚¿ã‚¤ãƒˆãƒ«: {session_info['title']}")
  if session_info['description']:
      print(f"èª¬æ˜: {session_info['description']}")
  print(f"é–‹å§‹: {session_info['started_at']}")
  print(f"ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: {session_info['status']}")
  print()

  # çµ±è¨ˆæƒ…å ±
  updated_count = len(all_docs) - len(pending_docs)
  print(f"ğŸ“ˆ çµ±è¨ˆ:")
  print(f"  ç·ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•°: {len(all_docs)}")
  print(f"  æ›´æ–°æ¸ˆã¿: {updated_count}")
  print(f"  æœªæ›´æ–°: {len(pending_docs)}")
  print()

  if not all_docs:
      print("ğŸ“ è¿½è·¡ä¸­ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“")
      print("   /doc-track-add ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ãã ã•ã„")
  else:
      print("ğŸ“„ è¿½è·¡ä¸­ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:")
      print("-" * 60)
      for doc in all_docs:
          status = "âœ…" if doc['updated'] else "â³"
          print(f"{status} {doc['document_path']}")
          print(f"   ç†ç”±: {doc['reason']}")
          if doc['section']:
              print(f"   ã‚»ã‚¯ã‚·ãƒ§ãƒ³: {doc['section']}")
          if doc['line_start'] is not None or doc['line_end'] is not None:
              if doc['line_start'] is not None and doc['line_end'] is not None:
                  print(f"   è¡Œç¯„å›²: {doc['line_start']}-{doc['line_end']}")
              elif doc['line_start'] is not None:
                  print(f"   é–‹å§‹è¡Œ: {doc['line_start']}")
              elif doc['line_end'] is not None:
                  print(f"   çµ‚äº†è¡Œ: {doc['line_end']}")
          if doc['updated'] and doc['update_notes']:
              print(f"   æ›´æ–°ãƒ¡ãƒ¢: {doc['update_notes']}")
          print()

  if pending_docs:
      print("âš ï¸ æœªæ›´æ–°ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:")
      print("-" * 60)
      for doc in pending_docs:
          print(f"ğŸ“„ {doc['document_path']}")
          print(f"   ç†ç”±: {doc['reason']}")
          if doc['section']:
              print(f"   ã‚»ã‚¯ã‚·ãƒ§ãƒ³: {doc['section']}")
          if doc['line_start'] is not None or doc['line_end'] is not None:
              if doc['line_start'] is not None and doc['line_end'] is not None:
                  print(f"   è¡Œç¯„å›²: {doc['line_start']}-{doc['line_end']}")
              elif doc['line_start'] is not None:
                  print(f"   é–‹å§‹è¡Œ: {doc['line_start']}")
              elif doc['line_end'] is not None:
                  print(f"   çµ‚äº†è¡Œ: {doc['line_end']}")
          print()
      print("ğŸ’¡ ãƒ’ãƒ³ãƒˆ: å®Ÿè£…ãŒå®Œäº†ã—ãŸã‚‰ /doc-track-update ã‚’ä½¿ç”¨ã—ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°ã—ã¦ãã ã•ã„")

  tracker.close()

requires_approval: false
risk_level: low

metadata:
  author: MAO System
  tags:
    - documentation
    - tracking
    - status
  examples:
    - description: è¿½è·¡çŠ¶æ³ã‚’è¡¨ç¤º
      command: /doc-track-show
